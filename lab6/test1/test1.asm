TMOD_M	EQU	00010101B
I_TH0	EQU	0FFH
I_TL0	EQU	0FDH
I_TH1	EQU	03CH
I_TL1	EQU	0B0H
A_TIME1	EQU	20
A_TIME5	EQU	100
A_TIME10	EQU	200
A_LAMP	EQU	P2
SN_G	EQU	10011001B
EW_G	EQU	01100110B
MARK1	bit	0h	;0表示东西绿灯1表示南北绿灯
MARK2	bit	1h	;0表示东西1s，1表示东西5s
DEL_LEN	EQU	10H
	ORG	0000H
	LJMP	START
	ORG	000BH
	LJMP	T0_S
	ORG	001BH
	LJMP	T1_S
	ORG	0030H
START:	LCALL	INIT
MLOOP:	
	SJMP	MLOOP
INIT:
	MOV	TMOD,#TMOD_M
	MOV	TH0,#I_TH0
	MOV	TL0,#I_TL0
	MOV	R0,#0
	MOV	TH1,#I_TH1
	MOV	TL1,#I_TL1
	MOV	A_LAMP,#EW_G
	SETB	ET0
	SETB	EA
	SETB	TR0
	SETB	ET1
	SETB	TR1
	RET
T0_S:
	CLR	EA
	SETB	MARK2
	MOV	TH0,#I_TH0
	MOV	TL0,#I_TL0
	SETB	EA
	RETI
T1_S:	
	INC	R0
	JB	MARK1,TEN
	JB	MARK2,FIVE
ONE:	CJNE	R0,#A_TIME1,EXIT
	SJMP	TIME
FIVE:	CJNE	R0,#A_TIME5,EXIT
	SJMP	TIME
TEN:	CJNE	R0,#A_TIME10,EXIT
TIME:	
	JB	MARK1,EW
SN:	MOV	A_LAMP,#SN_G
	SETB	MARK1
	CLR	MARK2
	SJMP	EX
EW:	MOV	A_LAMP,#EW_G
	CLR		MARK1	
EX:	
	MOV	R0,#0
EXIT:	MOV	TH1,#I_TH1
	MOV	TL1,#I_TL1
	RETI
	END